# Fuff faster

Kolmas läksy Tunkeutumistestaus-kurssille.

Kurssi ja tehtävänanto löytyy [täältä](https://terokarvinen.com/2024/eettinen-hakkerointi-2024/#h3-fuff-faster).

## x) Lue ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva kustakin artikkelista. Kannattaa lisätä myös jokin oma ajatus, idea, huomio tai kysymys.)

### Find Hidden Web Directories - Fuzz URLs with ffuf

Lähde: https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

Ohje piilotettujen hakemistojen löytämiseen automaattisesti ffuf:n avulla.

Ffuf on fuzzaamiseen kehitetty työkalu, jonka on luonut joohoi, Joona Hoikkala.

- Lataa kohdesivu
- Kokeile sivun löytämistä manuaalisesti
- Asenna ffuf
- Lataa "sanakirja" yleisimmistä poluista
- Fuzzaa
- Filteröi tulokset
- Kokeile löytyykö sivu tuloksilla 

### Cracking Passwords with Hashcat

Lähde: https://terokarvinen.com/2022/cracking-passwords-with-hashcat/

Salasanat säilyteytään järjestelmissä hash-tiivisteinä.

Ohje salasanojen murtamiseen Hashcatin avulla.

- Asenna Hashcat
- Luo uusi hakemisto tuloksille
- Lataa salasana sanakirja/sanasto yleisimmistä salasanoista
- Identifioi hash-tyyppi
- Ratkaise salasana

### Crack File Password With John

Lähde: https://terokarvinen.com/2023/crack-file-password-with-john/

Ohje salasanojen murtamiseen John the Ripperin avulla.

- Asenna tarvittavat työkalut
- Asenna John the Ripper
- Lataa zip-tiedosto
- Murra salasana 

## a) Asenna Hashcat ja testaa sen toiminta murtamalla esimerkkisalasana.

Tein tehtävän aikaisemmin asentamallani Kali Linuxilla.

Apuna käytin [tätä](https://terokarvinen.com/2022/cracking-passwords-with-hashcat/) ohjetta.

Päivitin ensimmäiseksi koneen "pakettivaraston".

    sudo apt-get update


Sen jälkeen olin asentamassa kolmea eri ohjelmaa: hashID, Hashcat ja wget, mutta ne olikin jo kaikki valmiiksi asennettuna. HashID on työkalu, joka tunnistaa erilaisia hash-arvoja, Hashcat on työkalu, jolla murretaan salasanoja ja wget:n avulla voidaan hakea ja ladata tiedostoja.

    sudo apt-get install hashid hashcat wget

Loin uuden hakemiston, johon talletan kaikki tulokset. 

    mkdir hashkissa

Siirryin hakemistoon.

    cd hashkissa

Latasin Githubista wget-työkalun avulla halutun rockyou.txt -tiedoston.

    wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz

Purin tiedoston tar-työkalulla. Komennon `x`, extract tarkoittaa purkamista ja `f`, file tarkoittaa tiedostoa. Käytännössä siis `xf` määrittelee, että haluan purkaa tiedoston.

    tar xf rockyou.txt.tar.gz

Lopuksi poistin tarpeettoman tar.gz -tiedoston.

    rm rockyou.txt.tar.gz

Head-komennolla katsoin tekstitiedoston ensimmäisiä rivejä.

    head rockyou.txt

Tiedostossa on mahdollisia salasanoja listattuna:

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/ea4464a8-90b0-42d7-9d81-5bb8c65394a2">

Tiedoston rivimäärän tarkastin näin:

    wc -l rockyou.txt 

Komento `wc` tulostaa tiedoston rivimäärän (lines) `-l`, halutusta tiedostosta. 

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/5de3f9e3-dd8b-4b65-8158-b1a8309d4d19">

Rivejä oli yhteensä 14344391.

Salasanan murtamiseksi tarvitsen salasanan ja hash-arvon. Tein arvon täällä: https://md5.gromweb.com/ MD5 hashin.

Hash: 482c811da5d5b4bc6d497ffa98491e38

Tiedän valmiiksi, minkä tyyppinen hash on, mutta kokeilin vielä ajaa ohjeessa annetun komennon. `-m` eli mode tarkoittaa, että sisällytä vastaava hashcat mode tulosteessa. Vastauksena on lista erilaisista hash-tyypeistä.

         hashid -m 482c811da5d5b4bc6d497ffa98491e38

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/89502943-5beb-4762-9a2e-7ba3bb2c6676">

Ajoin hashcat-komennon, joka käyttää MD5 hash-tyyppiä `-m 0` ratkaistakseen annetun tiivisteen. Komento käy läpi rockyou.txt-tiedostoa, missä yleisimmät salasanat ovat. Lopuksi tulos tallennetaan `-o` tiedostoon nimeltä salasana.

         hashcat -m 0 '482c811da5d5b4bc6d497ffa98491e38' rockyou.txt -o salasana

Tulos ei ollut sellainen kuin olisin halunnut. Koneen muisti on liian pieni komennon suorittamiseen.

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/a761c391-ed93-4151-b666-868f08ac407c">

Sammutin koneen ja lisäsin muistia.

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/77e46858-e880-419f-b217-e91b3e37fdb6">

Käynnistin koneen ja testasin uudestaan. Nyt komento toimi.

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/a3b6709c-6bdb-4fcc-92c3-037bf9bd7dee">

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/c93e8005-2fad-4202-bf26-a9185c7c824b">

Mitä ymmärsin vastauksesta:

- hashcat käynnistyy
- tietoa OpenCL API:sta
- tietoa laitteesta
- kernelin tukemat salasanapituudet
- käytetään yhtä sääntöä
- varoitus optimoimattomista backend kerneleistä
- watchdog pitää huolta, että koneen lämpötila ei nouse yli 90 asteen
- vaadittu muisti, että hyökkäys voidaan suorittaa
- tietoja sanakirja-tiedostosta (dictionary)
- infoa suoritetusta komennosta
- aloitus- ja lopetusaika

Tarkistin tuloksen.

    cat salasana

Tiedostossa on hash-arvon salasana ymmärrettävässä muodossa. Salasana oli password123.

<img width="auto" alt="image" src="https://github.com/annihuh/tunkeutumistestaus/assets/101214286/09686e88-6158-4305-b500-3c45e7ce5b5c">

## b) Salainen, mutta ei multa. Ratkaise dirfuzt-1 artikkelista Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf



## c) Asenna John the Ripper ja testaa sen toiminta murtamalla jonkin esimerkkitiedoston salasana.



## d) Fuffme. Asenna Ffufme harjoitusmaali paikallisesti omalle koneellesi. Ratkaise tehtävät (kaikki paitsi ei "Content Discovery - Pipes")



## e) Tee msfvenom-työkalulla haittaohjelma, joka soittaa kotiin (reverse shell). Ota yhteys vastaan metasploitin multi/handler -työkalulla.



## f) Asenna Windows virtuaalikoneeseen. Voi olla esimerkiksi Metasploitable 3 tai Microsoftin sivuilta saatava ilmainen kokeiluversio.



## g) Ota Windowsiin graafinen etähallintayhteys Linuxista. Käytä RDP:tä eli Remote Desktop Protocol.



## Lähteet

https://terokarvinen.com/2024/eettinen-hakkerointi-2024/

https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

https://terokarvinen.com/2022/cracking-passwords-with-hashcat/

https://terokarvinen.com/2023/crack-file-password-with-john/

https://chat.openai.com/

Komentojen head ja wc man-sivut.

https://forum.hackthebox.com/t/hashcat-issue/265438
