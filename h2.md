# Scanning Cyberspace

Tehtävä h2. 

[Tehtävänanto](https://terokarvinen.com/2024/eettinen-hakkerointi-2024/#h2-scanning-cyberspace)

## x) Lue/katso ja tiivistä

### Lyon 2009: Nmap Network Scanning: Chapter 15. Nmap Reference Guide

[Port Scanning Basics](https://nmap.org/book/man-port-scanning-basics.html)

#### Open 

Portti on auki ja hyväksyy TCP yhteyksiä, UDP datagrammeja ja SCTP assosiaatioita aktiivisesti. Skannauksen pääidea on löytää avonaisia portteja.

#### Closed 

Portti on saatavilla ja vastaa Nmap paketteihin, mutta ei sovellusta kuuntelemassa. Tunnistaa onko kohde (host) päällä. Suositeltavaa blokata kyseiset portit palomuurilla.

#### Filtered 

Paketteja suodatetaan (palomuuri/reitittimen säännöt) etteivät ne eivät saavuta päämääränä olevaa porttia. Nmap ei osaa sanoa onko portti auki vai kiinni.

[Port Scanning Techniques](https://nmap.org/book/man-port-scanning-techniques.html)

#### -sS (TCP SYN)

Suosituin skannaustekniikka. Nopea, huomaamaton skannaus, joka ei avaa yhteyksiä loppuun asti (half-open). 

#### -sT (TCP connect)

Käytetään, jos SYN-skannaus ei ole vaihtoehto. Nmap pyytää käyttöjärjestelmää muodostamaan yhteyden kohdekoneeseen connect-pyynnöllä. Avaa yhteyden loppuun asti. Kestää kauemmin ja jättää todennäköisemmin jäljen kohteen lokeihin.

#### -sU (UDP)

Skannaa portteja lähettämällä UDP-paketin jokaiselle kohdeportille. UDP-porttien skannaus on hidasta.


### KKO 2003:36. Alaikäinen tuomittiin Osuuspankkikeskuksen porttiskannaamisesta, korkeimman oikeuden ratkaisu.

[Tietomurto, vahingonkorvaus](https://finlex.fi/fi/oikeus/kko/kko/2003/20030036)

- Syytetty (A) oli porttiskannannut Osuuspankkikeskus-OPK:n tietojärjestelmiä oikeudettomasti
- Korvausvaatimukseksi vaadittiin työntekijöiden ja asiantuntijoiden palkkakustannuksien määrä sekä vahingonkorvauksia yhteensä 150 000 markkaa
- A kiisti syytteen sekä vahingonkorvausvaatimukset
- Käräjäoikeus hylkäsi syytteen tietomurron yrityksestä sekä korvausvaatimukset, koska se piti mahdollisena, että joku muu kuin A oli ottanut yhteyttä kohdeyrityksen tietojärjestelmiin, vaikka:
  - porttiskannaus oli tehty A:n IP-osoitteesta, eikä osoitetta oltu väärennetty
  - A:n koneelta oli löytynyt soveltuva ohjelma sekä porttiskannauksella kerättyä tietoa/listoja
  - A:n koneesta ei löytynyt jälkiä ulkopuolisista käyttäjistä
- A sai sakon tietoliikenteen häiriöstä
- Valitus hovioikeuteen
- Turun hovioikeus katsoi, että A oli syyllistynyt tekoon
- Korvaukseksi A määrättiin suorittamaan 75 000 markan korvaukset
- A teki valituksen
- Korkein oikeus katsoi, että A on velvollinen korvaamaan kokonaisuudessaan aiheuttaneensa vahingon

### 0xdf: Flare-On 2021: credchecker

[Flare-On 2021: credchecker](https://0xdf.gitlab.io/flare-on-2021/credchecker)

Ensimmäiseksi tehtävässä etsitään portteja. Nmap-skannauksella löytyy portit 22, 80, 8338 ja 55555. 


## a) Asenna Kali virtuaalikoneeseen


## b) Asenna Metasploitable 2 virtuaalikoneeseen


## c) Tee koneille virtuaaliverkko


## d) Etsi Metasploitable porttiskannaamalla


## e) Porttiskannaa Metasploitable huolellisesti


## f) Tallenna portiskannauksen tulos tiedostoon käyttäen nmap:n omaa tallennusta


## g) Tallenna shell-sessio tekstitiedostoon script-työkalulla 


## h) Etsi kaikki maininnat jostain osoitteesta, palvelusta tai vastaavasta kaikista tallennetuista tuloksista ja lokeista


## i) Anna esimerkit nmap ajonaikaisista toiminnosta

## Lähteet

https://terokarvinen.com/2024/eettinen-hakkerointi-2024/#h2-scanning-cyberspace
https://nmap.org/book/man-port-scanning-basics.html
https://nmap.org/book/man-port-scanning-techniques.html

